# 개요
- 29cm에서 레거시를 제거한 이유와 그 방법론에 대한 설명
- IOS긴 하지만, 큰 범주에서의 방법론이 유사하다고 느껴 정리

# 내용
- 29cm의 IOS 코드에는 RootController라는 아주 오래된 클래스가 있었음
  - UI 구조에서 가장 하위 계층이었고, 앱 전반의 로직을 핸들링하고 있음
  - 다양한 곳에서 RootController를 의존하고 있었으며, 클래스의 코드량이 방대해짐

- 레거시를 제거해야 하는 타이밍
  1. 비즈니스 전개에 병목이 될 때
    - 새로운 피쳐를 개발해야 하는 과정에서, 본질적인 해결을 위해서는 의존성을 제거해야 했음
  2. 크리티컬한 이슈일 때
    - 메모리 주소 접근 타이밍과 생성 타이밍이 절묘하게 맞지 않아 크래시가 발생하는 건이 있었음
  3. 변화에 대한 대응이 필요할 때
    - 변경은 본질적으로 좋지 않으므로, 변경을 위한 변경은 삼가야 하지만, 변화에 대응할 수 있어야 함
      - 너무 이른 타이밍에 작업하는 것은 우선순위에 맞지 않음
      - 너무 늦어지면 프로젝트에 병목이 됨
    - 레거시의 존재를 항상 인지하고, 적절한 청산 타이밍을 캐치할 수 있어야 함

- 레거시 뽑아내기
  - 큰 문제를 작게 나누고, 적절한 전략을 선택해야 하며 새로운 방향성을 공유 및 논의해야 함
  1. 레거시 다이어트
    - 불필요한 로직을 우선적으로 분석 및 제거하여 레거시의 영향력을 명확하게 하기
    - 하이럼 법칙에 의해 제작 의도와 다르게 사용되고 있었을 수 있음 (하이럼 법칙 : 사용자들이 많아질수록 API를 제작한 사람의 의도와는 상관없이 사용자들은 그 API에 접근할 수 있는 한 다양한 행위들을 저지를 수 있다)
    - 다른 클래스가 역할을 대신할 수 있는지, 제거할 수 있는지, 다른 기능에 영향을 주는지 등을 고려 - 체스터슨의 울타리 원칙 (더 현명한 개혁가는 “용도를 모르겠다면 그냥 밀어버리게 둘 순 없죠. 가서 더 생각해 봅시다. 용도를 알아내면 그때 철거할지 결정하자고요.”라고 말할 것입니다)
    - 나름대로의 히스토리가 분명 존재하기 때문에, 항상 대응책이 필요
  2. 레거시의 진로 고민하기
    - 수명 연장이 필요한 경우, 새로운 거처가 필요하고, 적절한 역할과 책임이 필요
    - 의사결정 문서를 적극적으로 활용
    - 배경, 제안, 해결방안을 정리
    - 문제를 일찍 발견한다면 더 효율적인 작업 가능 
  3. 롤백 환경 마련하기
    - 원격으로 코드를 분기할 수 있는 Remote Flag 기능 사용
    - 개발 안정성, 데이터 정합성, 실험 결과의 즉시 반영을 위해 적절한 분기 로직 개발 필요

- 마무리
  - 서비스가 변화에 대응할 수 있는 지속가능성을 갖추어 나가는 과정
  - 위의 원칙을 따라 가면 잘 작업할 수 있을 것이라고 생각됨


# 참고문헌
- https://medium.com/29cm/6%EB%85%84-%EB%AC%B5%EC%9D%80-%EB%A0%88%EA%B1%B0%EC%8B%9C-rootcontroller-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81%ED%95%98%EA%B8%B0-424d4259f531